import{s as ge,r as T,k as N,z as me,D as fe,o as k,d as W,a as m,J as ve,u as O,i as q,n as Q,K as J,e as L,H as X,A as D,c as V,w as b,b as x,f as M,l as ee,L as te,P as oe,F as he,g as pe,I as ye}from"./app-CZNMuXyv.js";import{_ as be,a as xe}from"./AppLayout-B-_1m5wu.js";import we from"./PivotItem-DjGco3g7.js";import{_ as A}from"./PrimaryButton-Dv3cuahV.js";import{d as R}from"./index-D4V4tgYl.js";import{_ as $e}from"./TagBox-D1H7U3OL.js";import{T as Y}from"./Tooltip-BZhMXdVp.js";import{Z as Te,T as Se}from"./ZoomIcon-DZLgk69i.js";import{_ as Ie}from"./ConfirmDeleteButton-Bl8rpGu-.js";import{_ as ke}from"./TagShortcutBox-lA1C6f4w.js";import{_ as ae}from"./ToggleInput-DtATc2LJ.js";import{_ as Oe}from"./Modal-B-odY7TB.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconDangerButton-Ck-pzSvo.js";import"./TextInput-BUY0sAWZ.js";import"./SimpleTagShortcutItem-Bp4iMjuy.js";var Pe=Object.defineProperty,Ee=Object.defineProperties,ze=Object.getOwnPropertyDescriptors,le=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,re=(e,a,l)=>a in e?Pe(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,We=(e,a)=>{for(var l in a)Le.call(a,l)&&re(e,l,a[l]);if(le)for(var l of le(a))Me.call(a,l)&&re(e,l,a[l]);return e},Ce=(e,a)=>Ee(e,ze(a)),C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ue="Expected a function",ne=NaN,Be="[object Symbol]",Fe=/^\s+|\s+$/g,Ve=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,De=/^0o[0-7]+$/i,Ae=parseInt,Re=typeof C=="object"&&C&&C.Object===Object&&C,He=typeof self=="object"&&self&&self.Object===Object&&self,Xe=Re||He||Function("return this")(),Ye=Object.prototype,_e=Ye.toString,Ze=Math.max,Ke=Math.min,_=function(){return Xe.Date.now()};function Ge(e,a,l){var n,s,v,c,i,u,h=0,p=!1,w=!1,j=!0;if(typeof e!="function")throw new TypeError(Ue);a=ie(a)||0,K(l)&&(p=!!l.leading,w="maxWait"in l,v=w?Ze(ie(l.maxWait)||0,a):v,j="trailing"in l?!!l.trailing:j);function S(r){var g=n,d=s;return n=s=void 0,h=r,c=e.apply(d,g),c}function U(r){return h=r,i=setTimeout(I,a),p?S(r):c}function B(r){var g=r-u,d=r-h,f=a-g;return w?Ke(f,v-d):f}function P(r){var g=r-u,d=r-h;return u===void 0||g>=a||g<0||w&&d>=v}function I(){var r=_();if(P(r))return E(r);i=setTimeout(I,B(r))}function E(r){return i=void 0,j&&n?S(r):(n=s=void 0,c)}function z(){i!==void 0&&clearTimeout(i),h=0,n=u=s=i=void 0}function F(){return i===void 0?c:E(_())}function $(){var r=_(),g=P(r);if(n=arguments,s=this,u=r,g){if(i===void 0)return U(u);if(w)return i=setTimeout(I,a),S(u)}return i===void 0&&(i=setTimeout(I,a)),c}return $.cancel=z,$.flush=F,$}function K(e){var a=typeof e;return!!e&&(a=="object"||a=="function")}function qe(e){return!!e&&typeof e=="object"}function Qe(e){return typeof e=="symbol"||qe(e)&&_e.call(e)==Be}function ie(e){if(typeof e=="number")return e;if(Qe(e))return ne;if(K(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=K(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=e.replace(Fe,"");var l=Ne.test(e);return l||De.test(e)?Ae(e.slice(2),l?2:8):Ve.test(e)?ne:+e}var Je=Ge,ce="Expected a function",se=NaN,et="[object Symbol]",tt=/^\s+|\s+$/g,ot=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,rt=parseInt,nt=typeof C=="object"&&C&&C.Object===Object&&C,it=typeof self=="object"&&self&&self.Object===Object&&self,st=nt||it||Function("return this")(),ut=Object.prototype,dt=ut.toString,mt=Math.max,ft=Math.min,Z=function(){return st.Date.now()};function ct(e,a,l){var n,s,v,c,i,u,h=0,p=!1,w=!1,j=!0;if(typeof e!="function")throw new TypeError(ce);a=ue(a)||0,H(l)&&(p=!!l.leading,w="maxWait"in l,v=w?mt(ue(l.maxWait)||0,a):v,j="trailing"in l?!!l.trailing:j);function S(r){var g=n,d=s;return n=s=void 0,h=r,c=e.apply(d,g),c}function U(r){return h=r,i=setTimeout(I,a),p?S(r):c}function B(r){var g=r-u,d=r-h,f=a-g;return w?ft(f,v-d):f}function P(r){var g=r-u,d=r-h;return u===void 0||g>=a||g<0||w&&d>=v}function I(){var r=Z();if(P(r))return E(r);i=setTimeout(I,B(r))}function E(r){return i=void 0,j&&n?S(r):(n=s=void 0,c)}function z(){i!==void 0&&clearTimeout(i),h=0,n=u=s=i=void 0}function F(){return i===void 0?c:E(Z())}function $(){var r=Z(),g=P(r);if(n=arguments,s=this,u=r,g){if(i===void 0)return U(u);if(w)return i=setTimeout(I,a),S(u)}return i===void 0&&(i=setTimeout(I,a)),c}return $.cancel=z,$.flush=F,$}function gt(e,a,l){var n=!0,s=!0;if(typeof e!="function")throw new TypeError(ce);return H(l)&&(n="leading"in l?!!l.leading:n,s="trailing"in l?!!l.trailing:s),ct(e,a,{leading:n,maxWait:a,trailing:s})}function H(e){var a=typeof e;return!!e&&(a=="object"||a=="function")}function vt(e){return!!e&&typeof e=="object"}function ht(e){return typeof e=="symbol"||vt(e)&&dt.call(e)==et}function ue(e){if(typeof e=="number")return e;if(ht(e))return se;if(H(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=H(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=e.replace(tt,"");var l=at.test(e);return l||lt.test(e)?rt(e.slice(2),l?2:8):ot.test(e)?se:+e}var de=gt;const pt=["src"],yt={inheritAttrs:!1},G=ge(Ce(We({},yt),{props:{src:{default:""},width:{default:"100%"},height:{default:"auto"},className:{default:""},zoomImgSrc:{default:""},zoomFactor:{default:1.5},mgWidth:{default:150},mgHeight:{default:150},mgBorderWidth:{default:2},mgShape:{default:"circle"},mgShowOverflow:{type:Boolean,default:!0},mgMouseOffsetX:{default:0},mgMouseOffsetY:{default:0},mgTouchOffsetX:{default:()=>-50},mgTouchOffsetY:{default:()=>-50},mgShow:{type:Boolean,default:!0},mgCornerBgColor:{default:"#fff"}},emits:["image:load"],setup(e,{emit:a}){const l=T();let n=T(new DOMRect),s=T(!1),v=T(0),c=T(0),i=T(0),u=T(0);const h=N(()=>{let d="vue-magnifier__magnifying-glass";return s.value&&(d+=" vue-magnifier__visible"),e.mgShape==="circle"&&(d+=" vue-magnifier__circle"),d}),p=N(()=>({width:e.width,height:e.height,overflow:e.mgShowOverflow?"visible":"hidden"})),w=N(()=>({cursor:e.mgShow?"none":"",width:"100%",height:"100%"})),j=N(()=>({width:`${e.mgWidth}px`,height:`${e.mgHeight}px`,left:`calc(${i.value*100}% - ${e.mgWidth/2}px + ${v.value}px - ${e.mgBorderWidth}px)`,top:`calc(${u.value*100}% - ${e.mgHeight/2}px + ${c.value}px - ${e.mgBorderWidth}px)`,backgroundImage:`url(${e.zoomImgSrc||e.src})`,backgroundPosition:`calc(${i.value*100}% + ${e.mgWidth/2}px - ${i.value*e.mgWidth}px) calc(${u.value*100}% + ${e.mgHeight/2}px - ${u.value*e.mgWidth}px)`,backgroundSize:`${e.zoomFactor*n.value.width}% ${e.zoomFactor*n.value.height}%`,borderWidth:`${e.mgBorderWidth}px`,backgroundColor:e.mgCornerBgColor})),S=()=>{l.value&&(n.value=l.value.getBoundingClientRect())},U=d=>{a("image:load",d),S()},B=()=>{S()};let P=d=>{if(n.value){const f=d.target;v.value=e.mgMouseOffsetX,c.value=e.mgMouseOffsetY,i.value=(d.clientX-n.value.left)/f.clientWidth,u.value=(d.clientY-n.value.top)/f.clientHeight,s.value=!0}};const I=()=>{s.value=!1},E=()=>{S()};let z=d=>{if(n.value){const f=d.target,o=(d.targetTouches[0].clientX-n.value.left)/f.clientWidth,t=(d.targetTouches[0].clientY-n.value.top)/f.clientHeight;o>=0&&t>=0&&o<=1&&t<=1?(v.value=e.mgTouchOffsetX,c.value=e.mgTouchOffsetY,i.value=o,u.value=t,s.value=!0):s.value=!1}};const F=()=>{s.value=!1},$=Je(S,200);P=de(P,20,{trailing:!1}),z=de(z,20,{trailing:!1});const r=()=>{window.addEventListener("resize",$),window.addEventListener("scroll",$,!0)},g=()=>{window.removeEventListener("resize",$),window.removeEventListener("scroll",$,!0)};return me(()=>{r()}),fe(()=>{g()}),(d,f)=>(k(),W("div",{class:Q(`vue-magnifier__magnifier ${e.className}`),style:J(O(p))},[m("img",ve({ref_key:"img",ref:l,src:e.src},d.$attrs,{class:"vue-magnifier__magnifier-image",style:O(w),onLoad:f[0]||(f[0]=o=>U(o)),onMouseenter:f[1]||(f[1]=o=>B()),onMousemove:f[2]||(f[2]=o=>O(P)(o)),onMouseout:f[3]||(f[3]=o=>I()),onTouchstart:f[4]||(f[4]=q(o=>E(),["prevent"])),onTouchmove:f[5]||(f[5]=q(o=>O(z)(o),["prevent"])),onTouchend:f[6]||(f[6]=o=>F())}),null,16,pt),n.value&&e.mgShow?(k(),W("div",{key:0,class:Q(O(h)),style:J(O(j))},null,6)):L("",!0)],6))}}));G.install=e=>{e.component("VueMagnifier",G)};const bt={class:"flex justify-between relative"},xt={class:"absolute right-0 top-1/2 transform -translate-y-1/2"},wt={key:0},$t={class:"max-w-9xl mx-auto py-10 sm:px-6 lg:px-8"},Tt={class:"flex flex-col md:flex-row md:space-x-8"},St={class:"w-full md:w-1/2 lg:w-1/3 px-4"},It={key:0,class:"flex flex-row justify-between mb-6"},kt={class:"w-24 sm:w-28 xl:w-36"},Ot={for:"zoom-level",class:"group relative block text-sm font-medium max-w-min whitespace-nowrap"},jt={class:"w-24 sm:w-28 xl:w-36"},Pt={key:1,class:"flex justify-between mt-4"},Et={class:"w-full md:w-1/2 lg:w-2/3 px-4 min-h-96 space-y-6 mt-6 md:mt-0 mb-36"},zt={key:0,class:"flex flex-row items-center"},Lt={class:"ml-4"},Mt={class:"flex flex-row items-center"},Wt={class:"ml-4"},Ct={key:1},Ut={class:"mt-2"},Bt=["src","alt"],Ft={__name:"Show",props:{photoId:Number,items:Array,tags:Object,nextPhotoUrl:String,previousPhotoUrl:String,tagShortcuts:Array},setup(e){const a=e,l=T(null),n=T(null),s=T(null),v=T(localStorage.getItem("tagShortcutsEnabled")==="true"||!1),c=T(localStorage.getItem("zoomingEnabled")!=="false"),i=T(!1),u=T(parseFloat(localStorage.getItem("zoomLevel"))||.9),h=T(parseInt(localStorage.getItem("zoomMagnifierSize"))||350);me(()=>{p(),window.addEventListener("keydown",$)}),fe(()=>{window.removeEventListener("keydown",$)});const p=()=>{axios.get(`/photos/${a.photoId}`).then(o=>{l.value=o.data.photo}).catch(o=>{console.log(o)})},w=()=>{X.delete(`/photos/${l.value.id}`)},j=()=>{axios.post(`/photos/${l.value.id}/items`,{item_ids:[n.value.id]}).then(()=>{n.value=null,p()})},S=o=>{axios.delete(`/photo-items/${o}`).then(()=>{p()})},U=o=>{axios.post(`/photo-items/${o}/copy`).then(()=>{p()})},B=(o,t)=>{axios.post(`/photo-items/${o.id}/tags`,{tag_ids:t}).then(()=>{p()})},P=(o,t)=>{axios.delete(`/photo-items/${o.id}/tags/${t}`).then(()=>{p()})},I=R((o,t)=>{axios.post(`/photo-items/${o}`,{picked_up:t}).then(()=>{p()})},1e3,{leading:!0,trailing:!0}),E=R((o,t)=>{axios.post(`/photo-items/${o}`,{recycled:t}).then(()=>{p()})},1e3,{leading:!0,trailing:!0}),z=R((o,t)=>{axios.post(`/photo-items/${o}`,{deposit:t}).then(()=>{p()})},1e3,{leading:!0,trailing:!0}),F=R((o,t)=>{axios.post(`/photo-items/${o}`,{quantity:t}).then(()=>{p()})},1e3,{leading:!0,trailing:!0}),$=o=>{(o.ctrlKey||o.metaKey)&&(o.code==="ArrowLeft"&&a.previousPhotoUrl?(o.preventDefault(),X.visit(a.previousPhotoUrl)):o.code==="ArrowRight"&&a.nextPhotoUrl&&(o.preventDefault(),X.visit(a.nextPhotoUrl)))},r=()=>{s.value&&(axios.post(`/photos/${l.value.id}/tag-shortcuts/${s.value.id}`).then(()=>p()),s.value=null)};D(v,o=>{localStorage.setItem("tagShortcutsEnabled",o?"true":"false")}),D(c,o=>{localStorage.setItem("zoomingEnabled",o?"true":"false")}),D(u,o=>{localStorage.setItem("zoomLevel",o)}),D(h,o=>{localStorage.setItem("zoomMagnifierSize",o)});const g=o=>{v.value=o},d=o=>{c.value=o},f=o=>{if(!o.ctrlKey&&!o.metaKey)return;o.preventDefault(),c.value=!0;let t=parseFloat(o.deltaY>0?u.value-.05:u.value+.05)||.9;u.value=Math.min(2,Math.max(.4,t.toFixed(2)))};return(o,t)=>(k(),V(be,{title:"See Photo"},{header:b(()=>[m("div",bt,[t[12]||(t[12]=m("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," See Photo ",-1)),m("div",xt,[x(xe,{align:"right",width:"64"},{trigger:b(()=>t[9]||(t[9]=[m("button",{class:"flex items-center justify-center w-8 h-8 border-2 border-transparent rounded-full focus:outline-none focus:border-gray-300 transition"},[m("i",{class:"fas fa-gear text-lg text-gray-800 dark:text-gray-200 mt-0.5 sm:ml-[1px]"})],-1)])),content:b(()=>[m("div",null,[x(ae,{modelValue:v.value,"onUpdate:modelValue":[t[0]||(t[0]=y=>v.value=y),g],class:"block w-full px-4 py-2"},{label:b(()=>t[10]||(t[10]=[M("Tag Shortcuts enabled")])),_:1},8,["modelValue"]),x(ae,{modelValue:c.value,"onUpdate:modelValue":[t[1]||(t[1]=y=>c.value=y),d],class:"block w-full px-4 py-2"},{label:b(()=>t[11]||(t[11]=[M("Zooming enabled")])),_:1},8,["modelValue"])])]),_:1})])])]),default:b(()=>[l.value?(k(),W("div",wt,[m("div",$t,[m("div",Tt,[m("div",St,[c.value?(k(),W("div",It,[m("div",kt,[m("label",Ot,[x(Y,null,{default:b(()=>t[13]||(t[13]=[m("span",{class:"whitespace-nowrap text-white text-xs"},[M(" Ctrl (⌘) + "),m("br",{class:"xl:hidden"}),M(" Scroll on photo ")],-1)])),_:1}),t[14]||(t[14]=m("span",{class:"text-gray-900 dark:text-gray-100"},"Zoom Level",-1))]),ee(m("input",{id:"zoom-level",type:"range","onUpdate:modelValue":t[2]||(t[2]=y=>u.value=y),min:"0.4",max:"2",step:"0.05",class:"w-full h-1 bg-gray-200 accent-turqoFocus rounded-lg appearance-none cursor-pointer dark:bg-gray-700"},null,512),[[te,u.value]])]),m("div",jt,[t[15]||(t[15]=m("label",{for:"zoom-magnifier-size",class:"block text-sm font-medium text-gray-900 dark:text-gray-100"}," Magnifier Size ",-1)),ee(m("input",{id:"zoom-magnifier-size",type:"range","onUpdate:modelValue":t[3]||(t[3]=y=>h.value=y),min:"100",max:"500",step:"10",class:"w-full h-1 bg-gray-200 accent-turqoFocus rounded-lg appearance-none cursor-pointer dark:bg-gray-700"},null,512),[[te,h.value]])])])):L("",!0),m("div",{class:"relative group overflow-hidden",onWheel:f},[x(O(G),{src:l.value.full_path,alt:l.value.id,"mg-show":c.value,zoomFactor:u.value,mgWidth:h.value,mgHeight:h.value,mgBorderWidth:1,class:"w-full sm:max-w-2xl sm:overflow-hidden rounded-lg shadow-lg"},null,8,["src","alt","mg-show","zoomFactor","mgWidth","mgHeight"]),x(Te,{onClick:t[4]||(t[4]=y=>i.value=!0),class:"absolute top-0 left-0"}),l.value.photo_items.length?(k(),V(Se,{key:0,class:"absolute top-2 right-2"})):L("",!0),x(Ie,{onDelete:w,class:"absolute bottom-4 right-2"})],32),e.previousPhotoUrl||e.nextPhotoUrl?(k(),W("div",Pt,[e.previousPhotoUrl?(k(),V(O(oe),{key:0,href:e.previousPhotoUrl},{default:b(()=>[x(A,{class:"group relative"},{default:b(()=>[x(Y,null,{default:b(()=>t[16]||(t[16]=[m("span",{class:"whitespace-nowrap dark:text-white"},"Ctrl (⌘) + ←",-1)])),_:1}),t[17]||(t[17]=M(" Previous "))]),_:1})]),_:1},8,["href"])):L("",!0),e.nextPhotoUrl?(k(),V(O(oe),{key:1,href:e.nextPhotoUrl,class:"ml-auto"},{default:b(()=>[x(A,{class:"group relative"},{default:b(()=>[x(Y,null,{default:b(()=>t[18]||(t[18]=[m("span",{class:"whitespace-nowrap dark:text-white"},"Ctrl (⌘) + →",-1)])),_:1}),t[19]||(t[19]=M(" Next "))]),_:1})]),_:1},8,["href"])):L("",!0)])):L("",!0)]),m("div",Et,[v.value?(k(),W("div",zt,[x(ke,{class:"w-full md:w-96",modelValue:s.value,"onUpdate:modelValue":t[5]||(t[5]=y=>s.value=y),items:e.tagShortcuts,autofocus:!0,placeholder:"Tag Shortcuts"},null,8,["modelValue","items"]),m("div",Lt,[x(A,{class:"whitespace-nowrap",onClick:r,disabled:!s.value},{default:b(()=>t[20]||(t[20]=[M(" Apply Shortcut ")])),_:1},8,["disabled"])])])):L("",!0),m("div",Mt,[x($e,{autofocus:!v.value,class:"w-full md:w-96",items:e.items,modelValue:n.value,"onUpdate:modelValue":t[6]||(t[6]=y=>n.value=y),placeholder:"Litter Objects"},null,8,["autofocus","items","modelValue"]),m("div",Wt,[x(A,{class:"whitespace-nowrap",onClick:j,disabled:!n.value},{default:b(()=>t[21]||(t[21]=[M(" Add Object ")])),_:1},8,["disabled"])])]),l.value.photo_items.length?(k(),W("div",Ct,[t[22]||(t[22]=m("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"}," Litter Objects ",-1)),m("div",Ut,[x(ye,{tag:"ul",name:"items",role:"list",class:"grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3"},{default:b(()=>[(k(!0),W(he,null,pe(l.value.photo_items,y=>(k(),V(we,{key:y.id,pivotItem:y,tags:e.tags,onRemoveItem:S,onAddTagsToItem:B,onRemoveTagFromItem:P,onCopyItem:U,onTogglePickedUp:O(I),onToggleRecycled:O(E),onToggleDeposit:O(z),onUpdateQuantity:O(F)},null,8,["pivotItem","tags","onTogglePickedUp","onToggleRecycled","onToggleDeposit","onUpdateQuantity"]))),128))]),_:1})])])):L("",!0)])])]),x(Oe,{"max-width":"9xl",onClose:t[8]||(t[8]=y=>i.value=!1),show:i.value},{default:b(()=>[m("img",{src:l.value.full_path,alt:l.value.id,class:"w-full h-full object-contain",onClick:t[7]||(t[7]=y=>i.value=!1)},null,8,Bt)]),_:1},8,["show"])])):L("",!0)]),_:1}))}},to=je(Ft,[["__scopeId","data-v-540dc4ba"]]);export{to as default};
