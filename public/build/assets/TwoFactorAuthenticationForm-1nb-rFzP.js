import{r as y,O as N,o as t,d as r,a as u,p as E,b as n,w as o,f as l,t as C,N as B,n as k,m as Q,C as Y,k as D,A as G,c as _,e as m,u as V,F as I,g as O,q as U,H as R}from"./app-CZNMuXyv.js";import{_ as z}from"./ActionSection-H-M0v8Yw.js";import{_ as W}from"./DialogModal-DrzgfdmU.js";import{_ as q}from"./InputError-B5YukZOt.js";import{_ as A}from"./PrimaryButton-Dv3cuahV.js";import{_ as S}from"./SecondaryButton-BuvT1BGe.js";import{_ as H}from"./TextInput-BUY0sAWZ.js";import{_ as j}from"./DangerButton-SEmbVtR3.js";import{_ as J}from"./InputLabel-ChgMnCjb.js";import"./SectionTitle-B6ds_uDC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-B-odY7TB.js";const X={class:"mt-4"},h={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(x,{emit:T}){const c=T,a=y(!1),s=N({password:"",error:"",processing:!1}),p=y(null),g=()=>{axios.get(route("password.confirmation")).then(i=>{i.data.confirmed?c("confirmed"):(a.value=!0,setTimeout(()=>p.value.focus(),250))})},v=()=>{s.processing=!0,axios.post(route("password.confirm"),{password:s.password}).then(()=>{s.processing=!1,d(),Q().then(()=>c("confirmed"))}).catch(i=>{s.processing=!1,s.error=i.response.data.errors.password[0],p.value.focus()})},d=()=>{a.value=!1,s.password="",s.error=""};return(i,w)=>(t(),r("span",null,[u("span",{onClick:g},[E(i.$slots,"default")]),n(W,{show:a.value,onClose:d},{title:o(()=>[l(C(x.title),1)]),content:o(()=>[l(C(x.content)+" ",1),u("div",X,[n(H,{ref_key:"passwordInput",ref:p,modelValue:s.password,"onUpdate:modelValue":w[0]||(w[0]=F=>s.password=F),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:B(v,["enter"])},null,8,["modelValue"]),n(q,{message:s.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[n(S,{onClick:d},{default:o(()=>w[1]||(w[1]=[l(" Cancel ")])),_:1}),n(A,{class:k(["ml-3",{"opacity-25":s.processing}]),disabled:s.processing,onClick:v},{default:o(()=>[l(C(x.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},Z={key:0,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ee={key:1,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},te={key:2,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},oe={key:3},se={key:0},ae={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},re={key:0,class:"font-semibold"},ne={key:1},le=["innerHTML"],ie={key:0,class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},ue={class:"font-semibold"},ce=["innerHTML"],de={key:1,class:"mt-4"},me={key:1},fe={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 dark:bg-gray-900 rounded-lg"},pe={class:"mt-5"},ve={key:0},ye={key:1},Ve={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(x){const T=x,c=y(!1),a=y(!1),s=y(!1),p=y(null),g=y(null),v=y([]),d=Y({code:""}),i=D(()=>{var f;return!c.value&&((f=U().props.auth.user)==null?void 0:f.two_factor_enabled)});G(i,()=>{i.value||(d.reset(),d.clearErrors())});const w=()=>{c.value=!0,R.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([F(),L(),$()]),onFinish:()=>{c.value=!1,a.value=T.requiresConfirmation}})},F=()=>axios.get(route("two-factor.qr-code")).then(f=>{p.value=f.data.svg}),L=()=>axios.get(route("two-factor.secret-key")).then(f=>{g.value=f.data.secretKey}),$=()=>axios.get(route("two-factor.recovery-codes")).then(f=>{v.value=f.data}),P=()=>{d.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{a.value=!1,p.value=null,g.value=null}})},M=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>$())},K=()=>{s.value=!0,R.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{s.value=!1,a.value=!1}})};return(f,e)=>(t(),_(z,null,{title:o(()=>e[1]||(e[1]=[l(" Two Factor Authentication ")])),description:o(()=>e[2]||(e[2]=[l(" Add additional security to your account using two factor authentication. ")])),content:o(()=>[i.value&&!a.value?(t(),r("h3",Z," You have enabled two factor authentication. ")):i.value&&a.value?(t(),r("h3",ee," Finish enabling two factor authentication. ")):(t(),r("h3",te," You have not enabled two factor authentication. ")),e[11]||(e[11]=u("div",{class:"mt-3 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[u("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),i.value?(t(),r("div",oe,[p.value?(t(),r("div",se,[u("div",ae,[a.value?(t(),r("p",re," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),r("p",ne," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),u("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:p.value},null,8,le),g.value?(t(),r("div",ie,[u("p",ue,[e[3]||(e[3]=l(" Setup Key: ")),u("span",{innerHTML:g.value},null,8,ce)])])):m("",!0),a.value?(t(),r("div",de,[n(J,{for:"code",value:"Code"}),n(H,{id:"code",modelValue:V(d).code,"onUpdate:modelValue":e[0]||(e[0]=b=>V(d).code=b),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:B(P,["enter"])},null,8,["modelValue"]),n(q,{message:V(d).errors.code,class:"mt-2"},null,8,["message"])])):m("",!0)])):m("",!0),v.value.length>0&&!a.value?(t(),r("div",me,[e[4]||(e[4]=u("div",{class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[u("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),u("div",fe,[(t(!0),r(I,null,O(v.value,b=>(t(),r("div",{key:b},C(b),1))),128))])])):m("",!0)])):m("",!0),u("div",pe,[i.value?(t(),r("div",ye,[n(h,{onConfirmed:P},{default:o(()=>[a.value?(t(),_(A,{key:0,type:"button",class:k(["mr-3",{"opacity-25":c.value}]),disabled:c.value},{default:o(()=>e[6]||(e[6]=[l(" Confirm ")])),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(h,{onConfirmed:M},{default:o(()=>[v.value.length>0&&!a.value?(t(),_(S,{key:0,class:"mr-3"},{default:o(()=>e[7]||(e[7]=[l(" Regenerate Recovery Codes ")])),_:1})):m("",!0)]),_:1}),n(h,{onConfirmed:$},{default:o(()=>[v.value.length===0&&!a.value?(t(),_(S,{key:0,class:"mr-3"},{default:o(()=>e[8]||(e[8]=[l(" Show Recovery Codes ")])),_:1})):m("",!0)]),_:1}),n(h,{onConfirmed:K},{default:o(()=>[a.value?(t(),_(S,{key:0,class:k({"opacity-25":s.value}),disabled:s.value},{default:o(()=>e[9]||(e[9]=[l(" Cancel ")])),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(h,{onConfirmed:K},{default:o(()=>[a.value?m("",!0):(t(),_(j,{key:0,class:k({"opacity-25":s.value}),disabled:s.value},{default:o(()=>e[10]||(e[10]=[l(" Disable ")])),_:1},8,["class","disabled"]))]),_:1})])):(t(),r("div",ve,[n(h,{onConfirmed:w},{default:o(()=>[n(A,{type:"button",class:k({"opacity-25":c.value}),disabled:c.value},{default:o(()=>e[5]||(e[5]=[l(" Enable ")])),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Ve as default};
